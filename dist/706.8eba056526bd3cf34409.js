(self.webpackChunkcomplex_react=self.webpackChunkcomplex_react||[]).push([[706],{1749:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>u});var s=t(7294),r=t(7564),c=t(3983),l=t(195),n=t(3727),m=t(5615);const u=function(e){const a=(0,s.useRef)(null),t=(0,s.useContext)(r.Z),u=(0,s.useContext)(c.Z),i=(0,s.useRef)(null),o=(0,s.useRef)(null),[h,f]=(0,l.x)({fieldValue:"",chatMessages:[]});return(0,s.useEffect)((()=>{t.isChatOpen&&(i.current.focus(),u({type:"clearUnreadChatCount"}))}),[t.isChatOpen]),(0,s.useEffect)((()=>(a.current=(0,m.ZP)("http://localhost:8080"),a.current.on("chatFromServer",(e=>{f((a=>{a.chatMessages.push(e)}))})),()=>a.current.disconnect())),[]),(0,s.useEffect)((()=>{o.current.scrollTop=o.current.scrollHeight,h.chatMessages.length&&!t.isChatOpen&&u({type:"incrementUnreadChatCount"})}),[h.chatMessages]),s.createElement("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(t.isChatOpen?"chat-wrapper--is-visible":"")},s.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",s.createElement("span",{onClick:()=>u({type:"closeChat"}),className:"chat-title-bar-close"},s.createElement("i",{className:"fas fa-times-circle"}))),s.createElement("div",{id:"chat",className:"chat-log",ref:o},h.chatMessages.map(((e,a)=>e.username==t.user.username?s.createElement("div",{key:a,className:"chat-self"},s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},e.message)),s.createElement("img",{className:"chat-avatar avatar-tiny",src:e.avatar})):s.createElement("div",{key:a,className:"chat-other"},s.createElement(n.rU,{to:`/profile/${e.username}`},s.createElement("img",{className:"avatar-tiny",src:e.avatar})),s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},s.createElement(n.rU,{to:`/profile/${e.username}`},s.createElement("strong",null,e.username,": ")),e.message)))))),s.createElement("form",{onSubmit:function(e){e.preventDefault(),a.current.emit("chatFromBrowser",{message:h.fieldValue,token:t.user.token}),f((e=>{e.chatMessages.push({message:e.fieldValue,username:t.user.username,avatar:t.user.avatar}),e.fieldValue=""}))},id:"chatForm",className:"chat-form border-top"},s.createElement("input",{value:h.fieldValue,onChange:function(e){const a=e.target.value;f((e=>{e.fieldValue=a}))},ref:i,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off"})))}}}]);